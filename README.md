# Fipronil Residue Dynamic Simulation Tool

## ðŸ§ª Project Overview
A comprehensive GUI-based simulation tool for modeling the dynamic accumulation and depletion of fipronil pesticide residues in fish tissues. The tool implements a mass-balance fugacity model with numerical integration to predict residue concentrations over time, incorporating uncertainty analysis through sensitivity-based prediction bands.

## ðŸ”¬ Scientific Background
Fipronil (C12H4Cl2F6N4OS) is a broad-spectrum phenylpyrazole insecticide widely used in agricultural and veterinary applications. Due to its persistence and bioaccumulation potential in aquatic ecosystems, understanding its residue dynamics in fish is critical for ecological risk assessment and food safety evaluation.

## ðŸ“ Mathematical Model

### Core Mass-Balance Equation
The dynamic accumulation of fipronil in fish is described by the following differential equation:
d(f_B)/dt = [D_WÂ·f_W + D_DÂ·f_D - (D_W + D_F + D_M + D_G)Â·f_B] / (Z_BÂ·V_B)

Where:
- `f_B`: Fugacity in fish body (Pa)
- `t`: Time (hours)
- `D_W`: Gill uptake D-value (mol/PaÂ·h)
- `f_W`: Fugacity in water (Pa)
- `D_D`: Dietary uptake D-value (mol/PaÂ·h)
- `f_D`: Fugacity in food (Pa)
- `D_F`: Fecal excretion D-value (mol/PaÂ·h)
- `D_M`: Metabolic transformation D-value (mol/PaÂ·h)
- `D_G`: Growth dilution D-value (mol/PaÂ·h)
- `Z_B`: Fugacity capacity of fish (mol/PaÂ·mÂ³)
- `V_B`: Fish body volume (mÂ³)

### Fugacity Capacity Calculations
Z_W = 1 / H # Aqueous phase fugacity capacity
Z_O = K_OW / H # Lipid surrogate (octanol) fugacity capacity
Z_N = 0.035 Ã— K_OW / H # Non-lipid organic matter fugacity capacity
Z_B = F_LÂ·Z_O + F_NÂ·Z_N + F_WÂ·Z_W # Fish body fugacity capacity
Z_D = F_LDÂ·Z_O + F_NDÂ·Z_N + F_WDÂ·Z_W # Food fugacity capacity

### D-Value Calculations (Transport/Transformation Coefficients)
k_TR = ln(2) / t_1/2 # First-order transformation rate constant
Where `t_1/2` is the degradation half-life of fipronil in fish tissues.

### Numerical Solution Method
The system is solved using a 4th-order Runge-Kutta (RK4) numerical integration scheme:
k1 = Î”t Ã— dfdt(t_n, f_n)
k2 = Î”t Ã— dfdt(t_n + Î”t/2, f_n + k1/2)
k3 = Î”t Ã— dfdt(t_n + Î”t/2, f_n + k2/2)
k4 = Î”t Ã— dfdt(t_n + Î”t, f_n + k3)
f_{n+1} = f_n + (k1 + 2k2 + 2k3 + k4)/6

## ðŸ“‹ Simulation Parameters

### Default Parameter Values
| Category | Parameter | Symbol | Default Value | Unit | Description |
|----------|-----------|---------|---------------|------|-------------|
| **Fipronil Properties** | Henry's Law Constant | H | 2.4 Ã— 10â»Â³ | PaÂ·mÂ³/mol | Air-water partitioning coefficient |
| | Octanol-Water Partition Coefficient (log) | logKow | 4.0 | dimensionless | Hydrophobicity indicator |
| | Degradation Half-Life | tâ‚/â‚‚ | 72.0 | hours | Metabolic transformation rate |
| | Metabolite Conversion Proportion | sum_vxy | 0.8 | dimensionless | Fraction converted to metabolites |
| **Fish Physiology** | Body Weight | W | 0.5 | kg | Wet weight of fish |
| | Lipid Volume Fraction | F_L | 0.05 | dimensionless | Proportion of lipids in body |
| | Non-Lipid Organic Fraction | F_N | 0.15 | dimensionless | Non-lipid organic matter |
| | Water Volume Fraction | F_W | 0.80 | dimensionless | Body water content |
| | Gill Ventilation Rate | G_W | 0.02 | mÂ³/h | Water flow across gills |
| | Gill Absorption Efficiency | E_W | 0.75 | dimensionless | Extraction efficiency at gills |
| | Feeding Rate | G_D | 0.005 | mÂ³/h | Volume of food processed per hour |
| | Intestinal Absorption Efficiency | E_D | 0.85 | dimensionless | Digestive tract absorption |
| | Food Absorption Fraction | Î² | 0.85 | dimensionless | Fraction absorbed from food |
| | Intestine-Fish Distribution Coefficient | K_DG | 2.0 | dimensionless | Gut-to-body transfer ratio |
| | Growth Rate Constant | k_g | 0.001 | hâ»Â¹ | Specific growth rate |
| **Environmental** | Water Fugacity | f_W | 1.2 Ã— 10â»âµ | Pa | Thermodynamic activity in water |
| | Food Fugacity | f_D | 3.5 Ã— 10â»âµ | Pa | Thermodynamic activity in food |
| **Food Composition** | Lipid Fraction | F_LD | 0.03 | dimensionless | Lipid content in food |
| | Non-Lipid Organic Fraction | F_ND | 0.12 | dimensionless | Non-lipid organic in food |
| | Water Fraction | F_WD | 0.85 | dimensionless | Water content in food |

## ðŸŽ¯ Uncertainty Analysis
The prediction band (90% confidence interval) is generated by perturbing four sensitive parameters by Â±5%:
1. **Henry's Law Constant (H)** - Affects aqueous phase partitioning
2. **Octanol-Water Partition Coefficient (logKow)** - Influences lipid affinity
3. **Water Fugacity (f_W)** - Represents exposure concentration variability
4. **Gill Ventilation Rate (G_W)** - Accounts for respiratory variability

The upper and lower bounds are calculated as:
C_upper = max[C_base, C(HÃ—1.05), C(logKowÃ—1.05), C(f_WÃ—1.05), C(G_WÃ—1.05)]
C_lower = min[C_base, C(HÃ—0.95), C(logKowÃ—0.95), C(f_WÃ—0.95), C(G_WÃ—0.95)]

## ðŸ”§ Unit Conversions
Residue concentrations are converted from fugacity to practical units:
C (ng/g) = f_B Ã— Z_B Ã— MW Ã— 1000
Where:
- `f_B`: Fish fugacity (Pa)
- `Z_B`: Fish fugacity capacity (mol/PaÂ·mÂ³)
- `MW`: Molecular weight of fipronil (252.1 g/mol)
- 1000: Conversion factor (ng/g)

## ðŸ“Š Output Results
### Graphical Output
- **Time Series Plot**: Residue concentration (ng/g wet weight) vs. time (days)
- **Prediction Band**: Shaded region representing 90% uncertainty interval
- **Key Metrics Annotation**: Maximum concentration, time-to-peak, steady-state values

### Numerical Output
1. **Maximum Residue Concentration**: Peak accumulation level
2. **Peak Occurrence Time**: Time to reach maximum concentration
3. **30-Day Steady-State Concentration**: Equilibrium concentration after prolonged exposure
4. **Prediction Band Bounds**: Upper and lower uncertainty limits at steady-state

### File Output
- PNG format plot automatically saved to user's desktop
- High resolution (300 DPI) with publication-quality formatting
- File naming: `Fipronil_Residue_Simulation_with_Prediction_Band.png`

## ðŸš€ Installation & Execution
### System Requirements
- Python 3.8 or higher
- 4GB RAM minimum
- 200MB disk space
- Graphical display for GUI interface

### Dependencies
```bash
numpy>=1.20.0      # Numerical computations
matplotlib>=3.5.0  # Plotting and visualization
tkinter            # GUI framework (included with Python)
